{% extends 'layout.html.twig' %}

{% block title %}Coordonnées{% endblock %}

{% block informationTitle %}
    Récapitulatif et paiement
{% endblock %}

{% block informationText %}
    Récapitulatif et paiement de votre réservation
{% endblock %}

{% block form %}
    {{ dump(app.session.get('CommandeLouvre')) }}
    <h3>Votre réservation </h3>
    <p>Vous prévoyez de visiter le musée du Louvre le <b>{{ app.session.get('CommandeLouvre').visitDate|date('d/m/Y') }}</b> pour la
        {{  app.session.get('CommandeLouvre').duration }}.</p>
    <h3>Votre billet</h3>
    <div class="table-responsive-vertical shadow-z-1">
        <table id="table" class="table table-hover table-mc-light-blue">
            <thead>
            <tr>
                <th>Billet</th>
                <th>Titulaire du billet</th>
                <th>Age</th>
                <th>Tarification</th>
                <th>Prix</th>
            </tr>
            </thead>
            <tbody>
            {% for ticket in app.session.get('CommandeLouvre').tickets %}
                <tr>
                    <td data-title="Billet">{{ loop.index }}</td>
                    <td data-title="Titulaire du billet">{{ ticket.name }} {{ ticket.lastName }}</td>
                    <td data-title="Age">{{ ticket.age|age }} ans</td>
                    <td data-title="Tarification">{{ ticket.rate }}</td>
                    <td data-title="Prix">{{ ticket.price }} €</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <h3>Total</h3>
    <div class="table-responsive-vertical shadow-z-1">
        <table id="table" class="table table-hover table-mc-light-blue">
            <thead>
            <tr>
                <th>Nombre de billets</th>
                <th>Date de visite</th>
                <th>Horaire d'accès</th>
                <th>Remise</th>
                <th>Prix total</th>
            </tr>
            </thead>
            <tbody>
                <tr>
                    <td data-title="Nombre de billets">{{ app.session.get('CommandeLouvre').nbTickets }}</td>
                    <td data-title="Date de visite">{{ app.session.get('CommandeLouvre').visitDate|date('d/m/Y') }}</td>
                    <td data-title="Horaire d'accès">{{ app.session.get('CommandeLouvre').duration }}</td>
                    <td data-title="Remise">N/A</td>
                    <td data-title="Prix total">{{ app.session.get('CommandeLouvre').price }} €</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="testPaiement">
    <form action="{{ path('confirmation') }}" method="POST">
        <script
                src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                data-label="Paiement par carte"
                data-key="pk_test_UkrYg88qxXhhJYayypUNfFuk"
                data-email = "{{ app.session.get('CommandeLouvre').email }}"
                data-amount="{{ app.session.get('CommandeLouvre').price }}00"
                data-name="Musée du louvre"
                data-description="Paiement de vos billets d'entrée"
                data-image="{{ asset('img/logo-louvre.jpg') }}"
                data-locale="auto"
                data-allow-remember-me="false"
                data-zip-code="false"
                data-currency="eur">
        </script>
    </form>
    </div>

{% endblock %}